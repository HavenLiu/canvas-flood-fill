$(function() {
	var e, d = document.getElementById("canvas"), f = d.getContext("2d"), g = new Image();
	g.onload = function() {
		f.drawImage(g, 0, 0)
	};
	g.src = "img_canvas.png";
	$("#wire").on("click", function(n) {
		if (!e) {
			alert("请选择你喜欢颜色！");
			return false
		}
		n = n.originalEvent || n;
		var k = $(this).offset();
		var l = Math.floor(n.pageX - k.left);
		var m = Math.floor(n.pageY - k.top);
		var p = f.getImageData(l, m, 1, 1);
		var q = p.data;
		if (q[0] === 0 && q[1] === 0 && q[2] === 0 && q[3] === 0) {
			alert("此处不能上色哦~");
			return false
		}
		var o = hexToRgb(e).split(",");
		o.push(255);
		floodFillLinear(d, l, m, o, 80);
		h = true
	});
	$("#colors").on("click", "li:not(.checked)", function() {
		var k = $(this);
		k.addClass("checked").siblings(".checked").removeClass("checked");
		e = k.html()
	});
});